<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monopoly - Jogo</title>
    <link rel="stylesheet" href="css/jogo.css" />
  </head>
  <body>
    <div id="appVue" v-cloak>
      <!-- Indicador de turno do Bot -->
      <div v-if="botPensando" class="bot-overlay">
        <div class="bot-indicator">
          <div class="bot-spinner"></div>
          <p class="bot-message">{{ mensagemBot }}</p>
        </div>
      </div>

      <!-- Modo Teste -->
      <div class="modo-teste-wrapper">
        <label>
          <input type="checkbox" v-model="modoTeste" />
          Modo Teste
        </label>
      </div>

      <!-- Timer da Partida -->
      <div class="timer-partida">
        <span class="timer-icone">‚è±Ô∏è</span>
        <span class="timer-tempo">{{ tempoFormatado }}</span>
      </div>

      <div class="board">
        <img src="assets/tabuleiro.jpg" class="imagem-fundo" />
        <div :style="EstilizarObjetoPosicao(areadados)">
          <!-- Modo Teste: Avan√ßar casas espec√≠ficas -->
          <div v-if="modoTeste" class="teste-controls">
            <input 
              type="number" 
              v-model.number="numeroCasasTeste" 
              class="input"
              placeholder="N¬∫ casas"
              min="0"
            />
            <button 
              @click="jogarTurno(jogadorAtivo, 1)" 
              class="buttonRodarDados"
              :class="{ bloqueado: dadosBloqueados }"
              :disabled="dadosBloqueados || (jogadorAtivo && jogadorAtivo.tipo === 'bot')">
              Avan√ßar Casas
            </button>
          </div>
          
          <!-- Modo Normal: Rodar dados -->
          <div class="normal-controls">
            <dados :numero1="dados.numero1" :numero2="dados.numero2"></dados>
            <button 
              @click="jogarTurno(jogadorAtivo)" 
              class="buttonRodarDados"
              :class="{ bloqueado: dadosBloqueados }"
              :disabled="dadosBloqueados || (jogadorAtivo && jogadorAtivo.tipo === 'bot')">
              Rodar Dados
            </button>
          </div>   
        </div>
        <div class="jogadores" :style="EstilizarObjetoPosicao(jogodiv)">
          <div 
            v-for="jogador in tabuleiro ? tabuleiro.jogadores : []" 
            :key="jogador.nome"
            :class="['jogador', { ativo: jogador === jogadorAtivo, falido: jogador.falido, bot: jogador.tipo === 'bot' }]"
          >
            <span class="nome">
              <span v-if="jogador.tipo === 'bot'" class="bot-badge">ü§ñ</span>
              <span class="cor-indicador" :style="{ backgroundColor: obterCorCSS(jogador.cor) }"></span>
              {{ jogador.nome }}
            </span>
            <span class="dinheiro">üí∞ {{ jogador.dinheiro }}</span>
          </div>
        </div>
        <div v-for="casa in tabuleiro.casas" 
            :id="'casa-' + casa.id" 
            class="city" 
            :style="EstilizarObjetoPosicao(casa)" 
            @click="jogadorAtivoAcao(casa, 1)">

          <!-- Jogadores nesta casa -->
           <peao v-for="(peaoCor, index) in casa.listaJogadores" 
                :key="peaoCor + '-' + index" 
                :cor="peaoCor" 
                :index="index"
                :total="casa.listaJogadores.length">
          </peao>

          <pino-casa v-if="casa.casaConstruida"
            :casa-construida="casa.casaConstruida" 
            :proprietario-cor="casa.proprietarioCor">
          </pino-casa> 

        </div>
      </div>


      <modal v-if="modal.mostra" :modal="modal" @confirmar-compra="confirmarCompra" @cancelar-compra="cancelarCompra" @pagar-aluguel="pagarAluguel" @casa-especial="funcaoEspecial" @dismiss="dismiss" @executar-carta-sorte="executarCartaSorte" @vender-propriedades="venderPropriedades" @declarar-falencia="declararFalencia" @pagar-fianca="pagarFiancaUFF"></modal>

      <escolha-bairro v-if="escolhaBairros.mostra"  :escolha-bairros="escolhaBairros" @selecionar-bairro="bairroSelecionado" @dismiss="dismiss"/>

    </div>

    <!-- Vue 2 -->
    <script src="assets/vue.js"></script>
    <script src="components/pino-casa.js"></script>
    <script src="components/peao.js"></script>
    <script src="components/dados.js"></script>
    <script src="components/modal.js"></script>
    <script src="components/escolha-bairro.js"></script>

    <!-- App principal -->
    <script type="module" src="jogo.js"></script>
  </body>
</html>
